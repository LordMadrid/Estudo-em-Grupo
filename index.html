
<!DOCTYPE html>
<html lang="pt-br">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Análise do Projeto</title>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <style>
    @import url('https://fonts.googleapis.com/css2?family=Aptos+Display:wght@400;700&display=swap');
    body {
      margin: 0;
      font-family: 'Aptos Display', sans-serif;
      background: linear-gradient(135deg, #2980b9, #6dd5fa);
      color: #000;
      overflow-x: hidden;
      position: relative;
    }
    canvas.particle {
      position: fixed;
      top: 0; left: 0;
      z-index: -1;
      width: 100vw;
      height: 100vh;
    }
    h1 { text-align: center; font-size: 2.5em; margin-top: 30px; color: white; }
    form {
      max-width: 700px; margin: auto; background: #ffffffdd; padding: 20px;
      border-radius: 16px; box-shadow: 0 0 20px rgba(0,0,0,0.1);
    }
    .question { margin-bottom: 20px; }
    label { font-weight: bold; display: block; margin-bottom: 5px; }
    select {
      width: 100%; padding: 8px; font-size: 16px;
      border-radius: 8px; border: 1px solid #ccc;
    }
    button {
      background-color: #2980b9; color: white; border: none;
      padding: 12px 24px; font-size: 16px; border-radius: 10px;
      cursor: pointer; display: block; margin: 30px auto 0;
    }
    button:hover { background-color: #1c5980; }
    #result {
      max-width: 800px; margin: 40px auto; padding: 20px;
      background: #fff; border-radius: 16px;
      box-shadow: 0 0 15px rgba(0,0,0,0.1);
    }
    table {
      width: 100%; margin-top: 30px; border-collapse: collapse;
    }
    th, td { padding: 12px; text-align: left; border: 1px solid #eee; }
    th { background-color: #f2f2f2; }
    .pro td { background-color: #e8fff0; }
    .contra td { background-color: #ffe8e8; }
    .suggestions {
      margin-top: 30px; padding: 15px;
      background: #f0f5ff; border-left: 5px solid #2980b9;
      border-radius: 8px;
    }
  </style>

<!-- Firebase App (the core Firebase SDK) -->
<script src="https://www.gstatic.com/firebasejs/10.12.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/10.12.0/firebase-firestore-compat.js"></script>
<script>
  const firebaseConfig = {'apiKey': 'AIzaSyAGCBI060-xyJOhmIqQETLGp6CAGuCIwQU', 'authDomain': 'estudo-de-caso-4d8cb.firebaseapp.com', 'projectId': 'estudo-de-caso-4d8cb', 'storageBucket': 'estudo-de-caso-4d8cb.firebasestorage.app', 'messagingSenderId': '129615747041', 'appId': '1:129615747041:web:188394b09de01e9f3d64a0'};
  firebase.initializeApp(firebaseConfig);
  const db = firebase.firestore();
</script>

</head>
<body>
  <canvas class="particle" id="bgCanvas"></canvas>
  <h1>Análise do Projeto</h1>

  <form id="reflectionForm">
<div class="question"><label>Seu nome:</label>
  <input type="text" id="userName" placeholder="Digite seu nome" required style="width:100%;padding:8px;border-radius:8px;border:1px solid #ccc;font-size:16px;">
</div>

    <div class="question"><label>1. Como você se sente com o projeto?</label>
      <select name="q1">
        <option value="pro">Satisfeito</option>
        <option value="contra">Pouco satisfeito</option>
        <option value="neutro">Indiferente</option>
      </select>
    </div>
    <div class="question"><label>2. Como você considera sua participação na equipe?</label>
      <select name="q2">
        <option value="pro">Satisfeito</option>
        <option value="contra">Pouco satisfeito</option>
        <option value="neutro">Indiferente</option>
      </select>
    </div>
    <div class="question"><label>3. Analisando de forma geral, o que você acha da frequência das reuniões?</label>
      <select name="q3">
        <option value="pro">Muito boa</option>
        <option value="contra">Poderia ser maior</option>
        <option value="neutro">Normal</option>
      </select>
    </div>
    <div class="question"><label>4. Como você se sente referente à liderança?</label>
      <select name="q4">
        <option value="pro">Confortável</option>
        <option value="contra">Poderia ser melhor</option>
        <option value="neutro">Seguro</option>
      </select>
    </div>
    <div class="question"><label>5. Como você avalia a comunicação entre os membros da equipe?</label>
      <select name="q5">
        <option value="pro">Satisfeito</option>
        <option value="contra">Pouco satisfeito</option>
        <option value="neutro">Indiferente</option>
      </select>
    </div>
    <div class="question"><label>6. Você sente que suas ideias são ouvidas e consideradas?</label>
      <select name="q6">
        <option value="pro">Satisfeito</option>
        <option value="contra">Pouco satisfeito</option>
        <option value="neutro">Indiferente</option>
      </select>
    </div>
    <div class="question"><label>7. O ambiente de trabalho é positivo e acolhedor?</label>
      <select name="q7">
        <option value="pro">Satisfeito</option>
        <option value="contra">Pouco satisfeito</option>
        <option value="neutro">Indiferente</option>
      </select>
    </div>
    <div class="question"><label>8. Você acredita que está se desenvolvendo profissionalmente neste projeto?</label>
      <select name="q8">
        <option value="pro">Satisfeito</option>
        <option value="contra">Pouco satisfeito</option>
        <option value="neutro">Indiferente</option>
      </select>
    </div>
    <button type="button" onclick="analisar()">Analisar</button>
  
<div style="text-align:center; margin-top:20px;">
  <button type="button" onclick="mostrarGrupo()">Mostrar Grupo</button>
  <button type="button" onclick="limparDados()" style="background-color:#e74c3c;margin-left:10px;">Limpar Dados</button>
</div>
</form>

  <div id="result"></div>

  <script>
    function analisar() {
      const form = document.forms['reflectionForm'];
      const selects = [...form.elements].filter(e => e.tagName === 'SELECT');
      let pro = 0, contra = 0;
      const pros = [], contras = [];

      selects.forEach((el) => {
        const val = el.value;
        const text = el.options[el.selectedIndex].text;
        const question = el.previousElementSibling.textContent;

        if (val === 'pro') { pro++; pros.push([question, text]); }
        else if (val === 'contra') { contra++; contras.push([question, text]); }
      });

      const total = pro + contra;
      const proPct = total ? Math.round(pro * 100 / total) : 0;
      const contraPct = 100 - proPct;
      const canvasID = `chart-${Date.now()}`;
      const barID = `bar-${Date.now()}`;

      let html = `
        <h2>Resultado da Análise</h2>
        <p><strong>${proPct}% Satisfeito</strong> vs <strong>${contraPct}% Pouco Satisfeito</strong></p>
        <canvas id="${canvasID}" width="300" height="300"></canvas>
        <canvas id="${barID}" width="400" height="250" style="margin-top:30px;"></canvas>
        <table><tr><th>Tipo</th><th>Pergunta</th><th>Resposta</th></tr>`;

      pros.forEach(([q, r]) => html += `<tr class="pro"><td>Satisfeito</td><td>${q}</td><td>${r}</td></tr>`);
      contras.forEach(([q, r]) => html += `<tr class="contra"><td>Pouco Satisfeito</td><td>${q}</td><td>${r}</td></tr>`);
      html += `</table>`;

      if (contra > pro) {
        html += `<div class="suggestions">
          <strong>Sugestões baseadas na sua análise:</strong>
          <ul>
            <li>Fortaleça a comunicação com sua equipe.</li>
            <li>Compartilhe suas percepções com a liderança.</li>
            <li>Explore formas de tornar o ambiente mais colaborativo.</li>
            <li>Busque oportunidades de desenvolvimento com apoio do grupo.</li>
          </ul>
        </div>`;
      }

      document.getElementById('result').innerHTML = html;

      new Chart(document.getElementById(canvasID), {
        type: 'pie',
        data: {
          labels: ['Satisfeito', 'Pouco satisfeito'],
          datasets: [{
            data: [proPct, contraPct],
            backgroundColor: ['#3498db', '#e74c3c']
          }]
        }
      });

      new Chart(document.getElementById(barID), {
        type: 'bar',
        data: {
          labels: ['Satisfeito', 'Pouco satisfeito'],
          datasets: [{
            label: 'Impacto (%)',
            data: [proPct, contraPct],
            backgroundColor: ['#2980b9', '#c0392b']
          }]
        },
        options: {
          scales: { y: { beginAtZero: true, max: 100 } }
        }
      });
    }

    const canvas = document.getElementById('bgCanvas');
    const ctx = canvas.getContext('2d');
    let balls = [];

    function resizeCanvas() {
      canvas.width = window.innerWidth;
      canvas.height = window.innerHeight;
    }
    window.addEventListener('resize', resizeCanvas);
    resizeCanvas();

    for (let i = 0; i < 60; i++) {
      balls.push({ x: Math.random()*canvas.width, y: Math.random()*canvas.height,
        r: Math.random()*15+5, dx: Math.random()*0.5-0.25, dy: Math.random()*0.5-0.25 });
    }
    function animate() {
      ctx.clearRect(0, 0, canvas.width, canvas.height);
      for (let b of balls) {
        ctx.beginPath();
        ctx.arc(b.x, b.y, b.r, 0, 2*Math.PI);
        ctx.fillStyle = 'rgba(255,255,255,0.7)';
        ctx.fill();
        b.x += b.dx; b.y += b.dy;
        if (b.x < 0 || b.x > canvas.width) b.dx *= -1;
        if (b.y < 0 || b.y > canvas.height) b.dy *= -1;
      }
      requestAnimationFrame(animate);
    }
    animate();
  </script>

<script>
  function analisar() {
    const form = document.forms['reflectionForm'];
    const userName = document.getElementById('userName').value.trim();
    if (!userName) return alert('Por favor, insira seu nome.');

    const selects = [...form.elements].filter(e => e.tagName === 'SELECT');
    let pro = 0, contra = 0;
    const pros = [], contras = [], respostas = {};

    selects.forEach((el, i) => {
      const val = el.value;
      const text = el.options[el.selectedIndex].text;
      const question = el.previousElementSibling.textContent;

      respostas['q' + (i+1)] = { pergunta: question, resposta: text, valor: val };

      if (val === 'pro') { pro++; pros.push([question, text]); }
      else if (val === 'contra') { contra++; contras.push([question, text]); }
    });

    db.collection("respostas").add({
      nome: userName,
      data: new Date().toISOString(),
      respostas: respostas
    }).then(() => {
      console.log("Dados salvos com sucesso");
    });

    const total = pro + contra;
    const proPct = total ? Math.round(pro * 100 / total) : 0;
    const contraPct = 100 - proPct;
    const canvasID = `chart-${Date.now()}`;
    const barID = `bar-${Date.now()}`;

    let html = `
      <h2>Resultado da Análise</h2>
      <p><strong>${proPct}% Satisfeito</strong> vs <strong>${contraPct}% Pouco Satisfeito</strong></p>
      <canvas id="${canvasID}" width="300" height="300"></canvas>
      <canvas id="${barID}" width="400" height="250" style="margin-top:30px;"></canvas>
      <table><tr><th>Tipo</th><th>Pergunta</th><th>Resposta</th></tr>`;

    pros.forEach(([q, r]) => html += `<tr class="pro"><td>Satisfeito</td><td>${q}</td><td>${r}</td></tr>`);
    contras.forEach(([q, r]) => html += `<tr class="contra"><td>Pouco Satisfeito</td><td>${q}</td><td>${r}</td></tr>`);
    html += `</table>`;

    if (contra > pro) {
      html += `<div class="suggestions">
        <strong>Sugestões baseadas na sua análise:</strong>
        <ul>
          <li>Fortaleça a comunicação com sua equipe.</li>
          <li>Compartilhe suas percepções com a liderança.</li>
          <li>Explore formas de tornar o ambiente mais colaborativo.</li>
          <li>Busque oportunidades de desenvolvimento com apoio do grupo.</li>
        </ul>
      </div>`;
    }

    document.getElementById('result').innerHTML = html;

    new Chart(document.getElementById(canvasID), {
      type: 'pie',
      data: {
        labels: ['Satisfeito', 'Pouco satisfeito'],
        datasets: [{
          data: [proPct, contraPct],
          backgroundColor: ['#3498db', '#e74c3c']
        }]
      }
    });

    new Chart(document.getElementById(barID), {
      type: 'bar',
      data: {
        labels: ['Satisfeito', 'Pouco satisfeito'],
        datasets: [{
          label: 'Impacto (%)',
          data: [proPct, contraPct],
          backgroundColor: ['#2980b9', '#c0392b']
        }]
      },
      options: {
        scales: { y: { beginAtZero: true, max: 100 } }
      }
    });
  }

  function mostrarGrupo() {
    db.collection("respostas").get().then(snapshot => {
      let totalPro = 0, totalContra = 0;
      snapshot.forEach(doc => {
        const data = doc.data();
        Object.values(data.respostas).forEach(r => {
          if (r.valor === "pro") totalPro++;
          else if (r.valor === "contra") totalContra++;
        });
      });

      const total = totalPro + totalContra;
      const pctPro = total ? Math.round(totalPro * 100 / total) : 0;
      const pctContra = 100 - pctPro;

      alert(`Grupo: ${pctPro}% Satisfeito, ${pctContra}% Pouco satisfeito`);
    });
  }

  function limparDados() {
    if (!confirm("Tem certeza que deseja apagar todos os dados?")) return;
    db.collection("respostas").get().then(snapshot => {
      const batch = db.batch();
      snapshot.forEach(doc => batch.delete(doc.ref));
      return batch.commit();
    }).then(() => {
      alert("Todos os dados foram apagados.");
    });
  }
</script>

</body>
</html>
